{{/*
@section: Testimonials Grid
@description: A responsive grid layout for displaying testimonials with optional featured testimonial, headings, and decorative background gradients.
@params:
  - bgColor: Background color class (optional, default: "bg-white")
  - padding: Padding classes (optional, default: "pt-24 pb-32 sm:pt-32")
  - cardBgColor: Card background color class (optional, default: "bg-white")
  - cardRingColor: Card border color class (optional, default: "ring-gray-900/5")
  - cardShadow: Card shadow class (optional, default: "shadow-lg")
  - captionFixedBottom: Whether to fix the caption at the bottom of the card (optional, default: true)
  - showHeading: Whether to display the heading section (optional, default: true)
  - headingTag: Small text displayed above the main heading (optional, default: "Testimonials")
  - headingTagColor: Color class for the heading tag (optional, default: "text-indigo-600")
  - heading: Main section heading (optional, default: "We have worked with thousands of amazing people")
  - headingColor: Color class for the main heading (optional, default: "text-gray-900")
  - gradientFrom: Starting color for background gradients (optional, default: "#ff80b5")
  - gradientTo: Ending color for background gradients (optional, default: "#9089fc")
  - testimonials: Array of testimonial objects (optional, includes defaults)
    - quote: Testimonial text
    - personImage: URL to the person's avatar image
    - personName: Name of the person giving testimonial
    - personHandle: Social media handle or title of the person
    - companyLogo: URL to company logo (optional)
    - companyLogoAlt: Alt text for company logo (optional)
    - featured: Boolean indicating if this testimonial should be featured/larger (optional)
@example:
  {{ partial "sections/testimonials/grid.html" (dict 
      "heading" "What our clients say" 
      "headingTag" "Customer Testimonials"
      "testimonials" (slice
          (dict 
              "quote" "This product transformed our workflow completely. The interface is intuitive and the features are exactly what we needed."
              "personImage" "/images/testimonials/jane-doe.jpg"
              "personName" "Jane Doe"
              "personHandle" "@janedoe"
              "companyLogo" "/images/logos/acme-inc.svg"
              "companyLogoAlt" "Acme Inc"
              "featured" true
          )
          (dict 
              "quote" "The support team was incredibly helpful during our onboarding process. Highly recommended."
              "personImage" "/images/testimonials/john-smith.jpg"
              "personName" "John Smith"
              "personHandle" "CTO at TechCorp"
          )
          (dict 
              "quote" "We've been using this platform for over a year now and it has significantly improved our productivity."
              "personImage" "/images/testimonials/emily-chen.jpg"
              "personName" "Emily Chen"
              "personHandle" "@emilychen"
          )
      )
      "gradientFrom" "#4f46e5"
      "gradientTo" "#818cf8"
  ) }}
@note: The grid layout automatically adjusts based on screen size, and one testimonial can be marked as "featured" to receive greater visual emphasis.
*/}}

{{/* Configurable variables */}}
{{ $bgColor := .bgColor | default "bg-white" }}
{{ $padding := .padding | default "pt-24 pb-32 sm:pt-32" }}
{{ $cardBgColor := .cardBgColor | default "bg-white" }}
{{ $cardRingColor := .cardRingColor | default "ring-gray-900/5" }}
{{ $cardShadow := .cardShadow | default "shadow-lg" }}
{{ $captionFixedBottom := true }}

{{/* Heading */}}
{{ $showHeading := .showHeading | default true }}
{{ $headingTag := .headingTag | default "Testimonials" }}
{{ $headingTagColor := .headingTagColor | default "text-indigo-600" }}
{{ $heading := .heading | default "We have worked with thousands of amazing people" }}
{{ $headingColor := .headingColor | default "text-gray-900" }}

{{/* Gradient colors */}}
{{ $gradientFrom := .gradientFrom | default "#ff80b5" }}
{{ $gradientTo := .gradientTo | default "#9089fc" }}

{{/* Testimonials */}}
{{ $testimonials := .testimonials | default slice }}

{{/* Default testimonials if none provided */}}
{{ if eq (len $testimonials) 0 }}
  {{ $testimonials = slice 
    (dict 
      "quote" "Integer id nunc sit semper purus. Bibendum at lacus ut arcu blandit montes vitae auctor libero. Hac condimentum dignissim nibh vulputate ut nunc. Amet nibh orci mi venenatis blandit vel et proin. Non hendrerit in vel ac diam."
      "personImage" "https://images.unsplash.com/photo-1550525811-e5869dd03032?ixlib=rb-=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=1024&h=1024&q=80"
      "personName" "Brenna Goyette"
      "personHandle" "@brennagoyette"
      "companyLogo" "https://tailwindcss.com/plus-assets/img/logos/savvycal-logo-gray-900.svg"
      "companyLogoAlt" "SavvyCal"
      "featured" true
    )
    (dict 
      "quote" "Laborum quis quam. Dolorum et ut quod quia. Voluptas numquam delectus nihil. Aut enim doloremque et ipsam."
      "personImage" "https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
      "personName" "Leslie Alexander"
      "personHandle" "@lesliealexander"
    )
    (dict 
      "quote" "Aut reprehenderit voluptatem eum asperiores beatae id. Iure molestiae ipsam ut officia rem nulla blanditiis."
      "personImage" "https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
      "personName" "Lindsay Walton"
      "personHandle" "@lindsaywalton"
    )
    (dict 
      "quote" "Voluptas quos itaque ipsam in voluptatem est. Iste eos blanditiis repudiandae. Earum deserunt enim molestiae ipsum perferendis recusandae saepe corrupti."
      "personImage" "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
      "personName" "Tom Cook"
      "personHandle" "@tomcook"
    )
    (dict 
      "quote" "Molestias ea earum quos nostrum doloremque sed. Quaerat quasi aut velit incidunt excepturi rerum voluptatem minus harum."
      "personImage" "https://images.unsplash.com/photo-1519345182560-3f2917c472ef?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
      "personName" "Leonard Krasner"
      "personHandle" "@leonardkrasner"
    )
  }}
{{ end }}

<div class="relative isolate {{ $bgColor }} {{ $padding }}">
  <div class="absolute inset-x-0 top-1/2 -z-10 -translate-y-1/2 transform-gpu overflow-hidden opacity-30 blur-3xl" aria-hidden="true">
    <div class="ml-[max(50%,38rem)] aspect-1313/771 w-[82.0625rem] bg-linear-to-tr from-[{{ $gradientFrom }}] to-[{{ $gradientTo }}]" style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div>
  </div>
  <div class="absolute inset-x-0 top-0 -z-10 flex transform-gpu overflow-hidden pt-32 opacity-25 blur-3xl sm:pt-40 xl:justify-end" aria-hidden="true">
    <div class="ml-[-22rem] aspect-1313/771 w-[82.0625rem] flex-none origin-top-right rotate-[30deg] bg-linear-to-tr from-[{{ $gradientFrom }}] to-[{{ $gradientTo }}] xl:mr-[calc(50%-12rem)] xl:ml-0" style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"></div>
  </div>
  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    {{ if $showHeading }}
    <div class="mx-auto max-w-2xl text-center">
      <h2 class="text-base/7 font-semibold {{ $headingTagColor }}">{{ $headingTag }}</h2>
      <p class="mt-2 text-4xl font-semibold tracking-tight text-balance {{ $headingColor }} sm:text-5xl">{{ $heading }}</p>
    </div>
    {{ end }}
    
    <!-- Simplified grid layout with proper structure -->
    <div class="mx-auto mt-16 grid max-w-7xl gap-8 sm:mt-20 md:grid-cols-2 lg:grid-cols-3">
      {{ range $index, $testimonial := $testimonials }}
        {{ if $testimonial.featured }}
          <!-- Featured testimonial (larger) -->
          <figure class="col-span-1 md:col-span-2 rounded-2xl {{ $cardBgColor }} ring-1 {{ $cardShadow }} {{ $cardRingColor }}">
            <blockquote class="p-6 text-lg font-semibold tracking-tight text-gray-900 sm:p-10 sm:text-xl/8">
              <p>"{{ $testimonial.quote }}"</p>
            </blockquote>
            <figcaption class="flex flex-wrap items-center gap-x-4 gap-y-4 border-t border-gray-900/10 px-6 py-4 sm:flex-nowrap">
              {{ if $testimonial.personImage }}
                {{ partial "components/media/lazyimg.html" (dict "src" $testimonial.personImage "alt" $testimonial.personName "class" "size-10 flex-none rounded-full bg-gray-50") }}
              {{ end }}
              <div class="flex-auto">
                <div class="font-semibold">{{ $testimonial.personName }}</div>
                <div class="text-gray-600">{{ $testimonial.personHandle }}</div>
              </div>
              {{ if $testimonial.companyLogo }}
                {{ partial "components/media/lazyimg.html" (dict "src" $testimonial.companyLogo "alt" $testimonial.companyLogoAlt "class" "h-10 w-auto flex-none") }}
              {{ end }}
            </figcaption>
          </figure>
        {{ else }}
          <!-- Regular testimonial -->
          <figure class="rounded-2xl {{ $cardBgColor }} p-6 ring-1 {{ $cardShadow }} {{ $cardRingColor }} relative min-h-[340px]">
            <blockquote class="text-gray-900">
              <p>"{{ $testimonial.quote }}"</p>
            </blockquote>
            <figcaption class="flex items-center gap-x-4 border-t border-gray-900/10 pt-4 absolute left-0 right-0 bottom-0 p-6 m-0">
              {{ if $testimonial.personImage }}
                {{ partial "components/media/lazyimg.html" (dict "src" $testimonial.personImage "alt" $testimonial.personName "class" "size-10 rounded-full bg-gray-50") }}
              {{ end }}
              <div>
                <div class="font-semibold">{{ $testimonial.personName }}</div>
                <div class="text-gray-600">{{ $testimonial.personHandle }}</div>
              </div>
            </figcaption>
          </figure>
        {{ end }}
      {{ end }}
    </div>
  </div>
</div>

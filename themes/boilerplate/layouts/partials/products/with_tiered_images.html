{{/* 
  Products partial with tiered images
  
  Parameters:
  - backgroundColor: Background color class (default: "bg-white")
  - product: Product object with the following structure:
    - title: Product title (default: "Basic Tee")
    - price: Product price (default: "$35")
    - rating: Product rating (default: "3.9")
    - reviewCount: Number of reviews (default: "512")
    - description: Product description
    - fabricCare: Array of fabric and care items
    - policies: Array of policy objects with icon, title, and description
    - colors: Array of color objects with name and class
    - sizes: Array of size objects with value, label, and disabled status
    - breadcrumbs: Array of breadcrumb objects with name and url
    - images: Array of image objects with url and alt text
*/}}

{{ $backgroundColor := .backgroundColor | default "bg-white" }}

{{ $product := .product | default (dict 
  "title" "Basic Tee"
  "price" "$35"
  "rating" "3.9"
  "reviewCount" "512"
  "description" (slice 
    "The Basic tee is an honest new take on a classic. The tee uses super soft, pre-shrunk cotton for true comfort and a dependable fit. They are hand cut and sewn locally, with a special dye technique that gives each tee it's own look."
    "Looking to stock your closet? The Basic tee also comes in a 3-pack or 5-pack at a bundle discount."
  )
  "fabricCare" (slice 
    "Only the best materials"
    "Ethically and locally made"
    "Pre-washed and pre-shrunk"
    "Machine wash cold with similar colors"
  )
  "policies" (slice 
    (dict 
      "icon" "<svg class=\"mx-auto size-6 shrink-0 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" aria-hidden=\"true\" data-slot=\"icon\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m6.115 5.19.319 1.913A6 6 0 0 0 8.11 10.36L9.75 12l-.387.775c-.217.433-.132.956.21 1.298l1.348 1.348c.21.21.329.497.329.795v1.089c0 .426.24.815.622 1.006l.153.076c.433.217.956.132 1.298-.21l.723-.723a8.7 8.7 0 0 0 2.288-4.042 1.087 1.087 0 0 0-.358-1.099l-1.33-1.108c-.251-.21-.582-.299-.905-.245l-1.17.195a1.125 1.125 0 0 1-.98-.314l-.295-.295a1.125 1.125 0 0 1 0-1.591l.13-.132a1.125 1.125 0 0 1 1.3-.21l.603.302a.809.809 0 0 0 1.086-1.086L14.25 7.5l1.256-.837a4.5 4.5 0 0 0 1.528-1.732l.146-.292M6.115 5.19A9 9 0 1 0 17.18 4.64M6.115 5.19A8.965 8.965 0 0 1 12 3c1.929 0 3.716.607 5.18 1.64\" /></svg>"
      "title" "International delivery"
      "description" "Get your order in 2 years"
    )
    (dict 
      "icon" "<svg class=\"mx-auto size-6 shrink-0 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" aria-hidden=\"true\" data-slot=\"icon\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\" /></svg>"
      "title" "Loyalty rewards"
      "description" "Don't look at other tees"
    )
  )
  "colors" (slice 
    (dict 
      "name" "Black"
      "class" "bg-gray-900"
    )
    (dict 
      "name" "Heather Grey"
      "class" "bg-gray-400"
    )
  )
  "sizes" (slice 
    (dict "value" "XXS" "label" "XXS" "disabled" false)
    (dict "value" "XS" "label" "XS" "disabled" false)
    (dict "value" "S" "label" "S" "disabled" false)
    (dict "value" "M" "label" "M" "disabled" false)
    (dict "value" "L" "label" "L" "disabled" false)
    (dict "value" "XL" "label" "XL" "disabled" true)
  )
  "breadcrumbs" (slice 
    (dict "name" "Women" "url" "#")
    (dict "name" "Clothing" "url" "#")
    (dict "name" "Basic Tee" "url" "#" "current" true)
  )
  "images" (slice 
    (dict 
      "url" "https://tailwindcss.com/plus-assets/img/ecommerce-images/product-page-01-featured-product-shot.jpg"
      "alt" "Back of women's Basic Tee in black."
      "class" "rounded-lg lg:col-span-2 lg:row-span-2"
    )
    (dict 
      "url" "https://tailwindcss.com/plus-assets/img/ecommerce-images/product-page-01-product-shot-01.jpg"
      "alt" "Side profile of women's Basic Tee in black."
      "class" "hidden rounded-lg lg:block"
    )
    (dict 
      "url" "https://tailwindcss.com/plus-assets/img/ecommerce-images/product-page-01-product-shot-02.jpg"
      "alt" "Front of women's Basic Tee in black."
      "class" "hidden rounded-lg lg:block"
    )
  )
) }}

<div class="{{ $backgroundColor }}">
  <div class="pt-6 pb-16 sm:pb-24">
    <nav aria-label="Breadcrumb" class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <ol role="list" class="flex items-center space-x-4">
        {{ range $index, $breadcrumb := $product.breadcrumbs }}
          <li>
            {{ if not $breadcrumb.current }}
              <div class="flex items-center">
                <a href="{{ $breadcrumb.url }}" class="mr-4 text-sm font-medium text-gray-900">{{ $breadcrumb.name }}</a>
                <svg viewBox="0 0 6 20" aria-hidden="true" class="h-5 w-auto text-gray-300">
                  <path d="M4.878 4.34H3.551L.27 16.532h1.327l3.281-12.19z" fill="currentColor" />
                </svg>
              </div>
            {{ else }}
              <div class="text-sm">
                <a href="{{ $breadcrumb.url }}" aria-current="page" class="font-medium text-gray-500 hover:text-gray-600">{{ $breadcrumb.name }}</a>
              </div>
            {{ end }}
          </li>
        {{ end }}
      </ol>
    </nav>
    <div class="mx-auto mt-8 max-w-2xl px-4 sm:px-6 lg:max-w-7xl lg:px-8">
      <div class="lg:grid lg:auto-rows-min lg:grid-cols-12 lg:gap-x-8">
        <div class="lg:col-span-5 lg:col-start-8">
          <div class="flex justify-between">
            <h1 class="text-xl font-medium text-gray-900">{{ $product.title }}</h1>
            <p class="text-xl font-medium text-gray-900">{{ $product.price }}</p>
          </div>
          <!-- Reviews -->
          <div class="mt-4">
            <h2 class="sr-only">Reviews</h2>
            <div class="flex items-center">
              <p class="text-sm text-gray-700">
                {{ $product.rating }}
                <span class="sr-only"> out of 5 stars</span>
              </p>
              <div class="ml-1 flex items-center">
                <!-- Star rating system -->
                {{ range $i := (seq 1 5) }}
                  {{ if le $i (math.Floor (float $product.rating)) }}
                    <svg class="size-5 shrink-0 text-yellow-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                      <path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z" clip-rule="evenodd" />
                    </svg>
                  {{ else }}
                    <svg class="size-5 shrink-0 text-gray-200" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                      <path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401Z" clip-rule="evenodd" />
                    </svg>
                  {{ end }}
                {{ end }}
              </div>
              <div aria-hidden="true" class="ml-4 text-sm text-gray-300">Â·</div>
              <div class="ml-4 flex">
                <a href="#" class="text-sm font-medium text-indigo-600 hover:text-indigo-500">See all {{ $product.reviewCount }} reviews</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Image gallery -->
        <div class="mt-8 lg:col-span-7 lg:col-start-1 lg:row-span-3 lg:row-start-1 lg:mt-0">
          <h2 class="sr-only">Images</h2>

          <div class="grid grid-cols-1 lg:grid-cols-2 lg:grid-rows-3 lg:gap-8">
            {{ range $index, $image := $product.images }}
              {{ partial "components/media/lazyimg.html" (dict 
                "src" $image.url
                "alt" $image.alt
                "class" $image.class
              ) }}
            {{ end }}
          </div>
        </div>

        <div class="mt-8 lg:col-span-5">
          <form>
            <!-- Color picker -->
            <div>
              <h2 class="text-sm font-medium text-gray-900">Color</h2>

              <fieldset aria-label="Choose a color" class="mt-2">
                <div class="flex items-center gap-x-3">
                  {{ range $index, $color := $product.colors }}
                    <!-- Active and Checked: "ring-3 ring-offset-1" -->
                    <label aria-label="{{ $color.name }}" class="relative -m-0.5 flex cursor-pointer items-center justify-center rounded-full p-0.5 ring-gray-900 focus:outline-hidden">
                      <input type="radio" name="color-choice" value="{{ $color.name }}" {{ if eq $index 0 }}checked{{ end }} class="sr-only">
                      <span aria-hidden="true" class="size-8 rounded-full border border-black/10 {{ $color.class }}"></span>
                    </label>
                  {{ end }}
                </div>
              </fieldset>
            </div>

            <!-- Size picker -->
            <div class="mt-8">
              <div class="flex items-center justify-between">
                <h2 class="text-sm font-medium text-gray-900">Size</h2>
                <a href="#" class="text-sm font-medium text-indigo-600 hover:text-indigo-500">See sizing chart</a>
              </div>

              <fieldset aria-label="Choose a size" class="mt-2">
                <div class="grid grid-cols-3 gap-3 sm:grid-cols-6">
                  {{ range $size := $product.sizes }}
                    <!--
                      In Stock: "cursor-pointer", Out of Stock: "opacity-25 cursor-not-allowed"
                      Active: "ring-2 ring-indigo-500 ring-offset-2"
                      Checked: "border-transparent bg-indigo-600 text-white hover:bg-indigo-700", Not Checked: "border-gray-200 bg-white text-gray-900 hover:bg-gray-50"
                    -->
                    <label class="flex {{ if $size.disabled }}cursor-not-allowed opacity-25{{ else }}cursor-pointer{{ end }} items-center justify-center rounded-md border px-3 py-3 text-sm font-medium uppercase focus:outline-hidden sm:flex-1">
                      <input type="radio" name="size-choice" value="{{ $size.value }}" {{ if $size.disabled }}disabled{{ end }} class="sr-only">
                      <span>{{ $size.label }}</span>
                    </label>
                  {{ end }}
                </div>
              </fieldset>
            </div>

            <button type="submit" class="mt-8 flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:outline-hidden">Add to cart</button>
          </form>

          <!-- Product details -->
          <div class="mt-10">
            <h2 class="text-sm font-medium text-gray-900">Description</h2>

            <div class="mt-4 space-y-4 text-sm/6 text-gray-500">
              {{ range $paragraph := $product.description }}
                <p>{{ $paragraph }}</p>
              {{ end }}
            </div>
          </div>

          <div class="mt-8 border-t border-gray-200 pt-8">
            <h2 class="text-sm font-medium text-gray-900">Fabric &amp; Care</h2>

            <div class="mt-4">
              <ul role="list" class="list-disc space-y-1 pl-5 text-sm/6 text-gray-500 marker:text-gray-300">
                {{ range $item := $product.fabricCare }}
                  <li class="pl-2">{{ $item }}</li>
                {{ end }}
              </ul>
            </div>
          </div>

          <!-- Policies -->
          <section aria-labelledby="policies-heading" class="mt-10">
            <h2 id="policies-heading" class="sr-only">Our Policies</h2>

            <dl class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2">
              {{ range $policy := $product.policies }}
                <div class="rounded-lg border border-gray-200 bg-gray-50 p-6 text-center">
                  <dt>
                    {{ partial "components/media/icon.html" (dict "icon" $policy.icon) }}
                    <span class="mt-4 text-sm font-medium text-gray-900">{{ $policy.title }}</span>
                  </dt>
                  <dd class="mt-1 text-sm text-gray-500">{{ $policy.description }}</dd>
                </div>
              {{ end }}
            </dl>
          </section>
        </div>
      </div>
    </div>
  </div>
</div>
